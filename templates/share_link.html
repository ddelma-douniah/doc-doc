{% extends "base.html" %}

{% block title %}Share Link - doc-doc{% endblock %}
{% block page_title %}Share Link{% endblock %}

{% block content %}
<div class="p-6 max-w-2xl mx-auto">
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-8">
        <!-- Icon -->
        <div class="w-16 h-16 bg-green-100 rounded-xl flex items-center justify-center mx-auto mb-6">
            <i class="fas fa-share-nodes text-3xl text-green-600"></i>
        </div>

        <!-- Title -->
        <h2 class="text-2xl font-bold text-gray-900 text-center mb-2">
            Share Link Created!
        </h2>
        <p class="text-gray-600 text-center mb-8">
            Anyone with this link can access your {% if share.file %}file{% else %}folder{% endif %}
        </p>

        <!-- File/Folder Info -->
        <div class="bg-gray-50 rounded-lg p-4 mb-6">
            <div class="flex items-center">
                <div class="w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center flex-shrink-0 mr-4">
                    <i class="fas fa-{% if share.file %}file-alt{% else %}folder{% endif %} text-2xl text-blue-500"></i>
                </div>
                <div class="flex-1 min-w-0">
                    <h3 class="font-semibold text-gray-900 truncate">{{ object.name }}</h3>
                    {% if share.file %}
                    <p class="text-sm text-gray-500">{{ object.formatted_size }}</p>
                    {% else %}
                    <p class="text-sm text-gray-500">Folder</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Share URL -->
        <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">
                Share Link
            </label>
            <div class="flex items-center space-x-2">
                <input type="text"
                       value="{{ share_url }}"
                       id="share-url"
                       readonly
                       class="flex-1 px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm font-mono">
                <button onclick="copyShareLink()"
                        class="px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors whitespace-nowrap">
                    <i class="fas fa-copy mr-2"></i>
                    Copy
                </button>
            </div>
            <p id="copy-message" class="hidden mt-2 text-sm text-green-600">
                <i class="fas fa-check mr-1"></i> Link copied to clipboard!
            </p>
        </div>

        <!-- Share Stats -->
        <div class="grid grid-cols-2 gap-4 mb-6">
            <div class="bg-gray-50 rounded-lg p-4 text-center">
                <div class="text-2xl font-bold text-gray-900">{{ share.access_count }}</div>
                <div class="text-sm text-gray-600">Views</div>
            </div>
            <div class="bg-gray-50 rounded-lg p-4 text-center">
                <div class="text-2xl font-bold text-gray-900">
                    {% if share.is_active %}
                    <span class="text-green-600">Active</span>
                    {% else %}
                    <span class="text-red-600">Inactive</span>
                    {% endif %}
                </div>
                <div class="text-sm text-gray-600">Status</div>
            </div>
        </div>

        <!-- Actions -->
        <div class="space-y-3">
            <a href="{{ share_url }}"
               target="_blank"
               class="block w-full text-center px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 text-gray-700 font-medium transition-colors">
                <i class="fas fa-external-link-alt mr-2"></i>
                Preview Link
            </a>
            <a href="{% url 'dashboard' %}"
               class="block w-full text-center px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors">
                <i class="fas fa-arrow-left mr-2"></i>
                Back to Dashboard
            </a>
        </div>
    </div>
</div>

<script>
function copyShareLink() {
    const input = document.getElementById('share-url');
    const message = document.getElementById('copy-message');

    input.select();
    input.setSelectionRange(0, 99999); // For mobile

    navigator.clipboard.writeText(input.value).then(() => {
        message.classList.remove('hidden');
        setTimeout(() => {
            message.classList.add('hidden');
        }, 3000);
    });
}
</script>
{% endblock %}
